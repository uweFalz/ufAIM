<!doctype html>
<html lang="de">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>ufAIM – Sandbox</title>

		<link rel="stylesheet" href="./styles.css" />

		<!-- Optional: Import maps if you use them in your project; keep if needed -->
		<script type="importmap">
			{
				"imports": {
					"three": "https://unpkg.com/three/build/three.module.js"
				}
			}
		</script>
		
		<script>
			if (
			location.hostname === "localhost" ||
			location.hostname === "127.0.0.1"
			) {
				navigator.serviceWorker?.register("./sw-nocache.js")
				.then(() => console.log("sw-nocache active (DEV) ✅"))
				.catch(err => console.warn("sw-nocache failed", err));
			}
		</script>
	</head>

	<body>
		<header class="topbar">
			<div class="brand">
				<div class="brand__title">ufAIM</div>
				<div class="brand__subtitle" id="status">…</div>
			</div>

			<div class="actions">
				<button id="btnReset" class="btn">Reset</button>

				<button id="btnSave" class="btn">Save (local)</button>
				<button id="btnExport" class="btn">Export JSON</button>

				<button id="btnImport" class="btn btn--primary">Import…</button>
				<input
				id="fileImport"
				type="file"
				accept=".json,.ufaim.json,.tra,.gra,application/json,text/plain"
				style="display:none"
				/>

				<button id="btnTrans" class="btn">Transition</button>
			</div>
		</header>

		<main class="layout">
			<section class="panel panel--left">
				<h2 class="panel__title">Controls</h2>

				<div class="control">
					<label for="s">s (Station)</label>
					<input id="s" type="range" min="0" max="1000" step="1" />
					<div class="hint" id="sVal">—</div>
				</div>

				<div class="control">
					<label for="u">u (0…1)</label>
					<input id="u" type="range" min="0" max="1000" step="1" />
					<div class="hint" id="uVal">—</div>
				</div>

				<div class="control">
					<label for="L">L</label>
					<input id="L" type="range" min="10" max="2000" step="1" />
					<div class="hint" id="LVal">—</div>
				</div>

				<div class="control">
					<label for="R">R</label>
					<input id="R" type="range" min="10" max="10000" step="1" />
					<div class="hint" id="RVal">—</div>
				</div>

				<hr />

				<h3 class="panel__subtitle">Readout</h3>
				<div class="readout3x3">
					<div class="readout__label">k0</div><div class="readout__value" id="k0Val">—</div>
					<div class="readout__label">k1</div><div class="readout__value" id="k1Val">—</div>
					<div class="readout__label">‖k‖</div><div class="readout__value" id="kappaVal">—</div>

					<div class="readout__label">L</div><div class="readout__value" id="LShow">—</div>
					<div class="readout__label">R</div><div class="readout__value" id="RShow">—</div>
					<div class="readout__label">—</div><div class="readout__value"> </div>
				</div>

				<hr />

				<h3 class="panel__subtitle">Log</h3>
				<pre id="log" class="log"></pre>
			</section>

			<section class="panel panel--center">
				<h2 class="panel__title">Views</h2>

				<div class="views">
					<div class="view view--3d">
						<div class="view__title">3D</div>
						<canvas id="view3d"></canvas>
					</div>

					<div class="view view--2d">
						<div class="view__title">2D</div>
						<div id="board2d" class="board2d"></div>
					</div>
				</div>
			</section>

			<section class="panel panel--right">
				<h2 class="panel__title">Props</h2>
				<pre id="props" class="props"></pre>

				<div id="toasts" class="toasts"></div>
			</section>
		</main>

		<!-- Transition Overlay -->
		<section id="transOverlay" class="overlay hidden">
			<div class="overlay__card">
				<header class="overlay__header">
					<div class="overlay__title">Transition Editor</div>
					<button id="btnTransClose" class="btn">Close</button>
				</header>

				<div class="control">
					<label for="familySel">Family</label>
					<select id="familySel"></select>
				</div>

				<div class="control">
					<label for="preset">Preset</label>
					<select id="preset">
						<option value="clothoid">clothoid</option>
						<option value="bloss">bloss</option>
						<option value="berlin">berlin</option>
					</select>
				</div>

				<div class="control">
					<label for="w1">w1</label>
					<input id="w1" type="range" min="0" max="1000" step="1" />
					<div class="hint" id="w1Val">—</div>
				</div>

				<div class="control">
					<label for="w2">w2</label>
					<input id="w2" type="range" min="0" max="1000" step="1" />
					<div class="hint" id="w2Val">—</div>
				</div>
			</div>
		</section>

		<script type="module" src="./main.js"></script>
	</body>
</html>
